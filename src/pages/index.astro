---
import { SITE_TITLE, SITE_TAGLINE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import Ava from '@src/assets/img/ava.jpg';
import Prose from '../components/Prose.astro';
import { projects } from './projects/projects';
import ProjectList from '../components/ProjectList.astro';
import PostItem from '../components/PostItem.astro';

type BlogPost = CollectionEntry<'blog'>;

const top6Projects = projects.slice(0, 6);
const posts = (await getCollection('blog'))
  .sort((a: BlogPost, b: BlogPost) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 4);
---

<BaseLayout title={SITE_TITLE + ' - ' + SITE_TAGLINE} description={SITE_DESCRIPTION}>
  <div class="container overflow-hidden">
    <!-- Canvas de part√≠culas -->
    <canvas id="cyber-particles" class="absolute inset-0 w-full z-0"></canvas>
    <div class="container relative z-10">
      <!-- Hero Section -->
      <section class="min-h-[80vh] flex items-center justify-center mb-20">
        <div class="w-full grid md:grid-cols-2 gap-12 items-center">
          <!-- Contenido Principal -->
          <div class="space-y-6 order-2 md:order-1">
            <div class="space-y-2">
              <p class="text-sm font-mono text-yellow-400 uppercase tracking-wider">Ciberseguridad & Developer</p>
              <h1 class="text-5xl md:text-6xl font-black leading-tight">
                <span class="block text-white">Hola, soy</span>
                <span class="block bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600 bg-clip-text text-transparent animate-gradient">
                  Ignacio Santiago
                </span>
              </h1>
              <p class="text-xl font-mono text-yellow-300/80">
                <span class="text-yellow-400">$</span> whoami ‚Üí <span class="text-yellow-300">tiaag0</span>
              </p>
            </div>
            
            <div class="space-y-4">
              <p class="text-lg text-gray-300 leading-relaxed">
                üíª Estudiante de Ingenier√≠a Civil Inform√°tica y Telecomunicaciones especializado en <span class="text-yellow-400 font-semibold">Ciberseguridad</span>. 
                Apasionado por descubrir vulnerabilidades y construir sistemas m√°s seguros.
              </p>
              
              <div class="flex flex-wrap gap-3 pt-4">
                <span class="px-4 py-2 bg-yellow-400/10 border border-yellow-400/30 rounded-lg text-sm font-mono text-yellow-300 hover:bg-yellow-400/20 transition-all">
                  Pentesting
                </span>
                <span class="px-4 py-2 bg-yellow-400/10 border border-yellow-400/30 rounded-lg text-sm font-mono text-yellow-300 hover:bg-yellow-400/20 transition-all">
                  Infraestructura
                </span>
                <span class="px-4 py-2 bg-yellow-400/10 border border-yellow-400/30 rounded-lg text-sm font-mono text-yellow-300 hover:bg-yellow-400/20 transition-all">
                  Desarrollo Software
                </span>
                <span class="px-4 py-2 bg-yellow-400/10 border border-yellow-400/30 rounded-lg text-sm font-mono text-yellow-300 hover:bg-yellow-400/20 transition-all">
                  Innovaci√≥n & IA
                </span>
              </div>
            </div>

            <div class="flex gap-4 pt-6">
              <a href="/posts/" class="group px-6 py-3 bg-gradient-to-r from-yellow-400 to-yellow-500 text-black font-bold rounded-lg hover:shadow-[0_0_30px_rgba(234,179,8,0.5)] transition-all duration-300 hover:scale-105">
                <span class="flex items-center gap-2">
                  Ver Posts
                  <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                  </svg>
                </span>
              </a>
              <a href="/projects/" class="px-6 py-3 border-2 border-yellow-400/50 text-yellow-400 font-bold rounded-lg hover:bg-yellow-400/10 hover:border-yellow-400 transition-all duration-300 hover:scale-105">
                Mis Proyectos
              </a>
            </div>

            <blockquote class="mt-8 text-sm font-mono text-gray-400 border-l-4 border-yellow-400/50 pl-4 py-2 bg-gray-900/20 rounded-r italic">
              <span class="text-yellow-400">"</span>The human factor is truly security's weakest link<span class="text-yellow-400">"</span>
              <span class="block text-xs text-yellow-300 mt-1">‚Äî Kevin Mitnick</span>
            </blockquote>
          </div>

          <!-- Imagen -->
          <div class="order-1 md:order-2 flex justify-center">
            <div class="relative" >
              <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-3xl blur-2xl opacity-20 animate-pulse"></div>
              <a href="/about/"><Image
                src={Ava} 
                alt="Ignacio Santiago" 
                width={400} 
                loading="eager" 
                class="relative rounded-3xl shadow-2xl border-2 border-yellow-500/30 hover:border-yellow-400/50 transition-all duration-500 hover:scale-105" 
              /></a>
              <div class="absolute -bottom-4 -right-4 px-4 py-2 bg-yellow-400 text-black font-mono text-sm font-bold rounded-lg shadow-lg">
                Welcome to my world!
              </div>
            </div>
          </div>
        </div>
      </section>

      <main>
        <!-- Secci√≥n de Posts -->
        <section class="mb-20">
          <div class="flex justify-between items-center mb-8">
            <div>
              <h2 class="text-3xl font-bold bg-gradient-to-r from-yellow-400 to-yellow-500 bg-clip-text text-transparent mb-2">
                √öltimas Publicaciones
              </h2>
              <p class="text-gray-400 font-mono text-sm">$ cat recent_posts.txt</p>
            </div>
            <a href="/posts/" class="group px-5 py-2.5 text-yellow-400 border border-yellow-400/50 rounded-lg font-mono text-sm font-semibold hover:bg-yellow-400/10 hover:shadow-[0_0_20px_rgba(234,179,8,0.3)] transition-all duration-300 hover:scale-105">
              <span class="flex items-center gap-2">
                Ver Todas
                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
              </span>
            </a>
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-6">
            {posts.map((post: BlogPost) => (
              <PostItem post={post} />
            ))}
          </div>
        </section>

        <!-- Secci√≥n de Proyectos -->
        <section>
          <div class="flex justify-between items-center mb-8">
            <div>
              <h2 class="text-3xl font-bold bg-gradient-to-r from-yellow-400 to-yellow-500 bg-clip-text text-transparent mb-2">
                Proyectos Destacados
              </h2>
              <p class="text-gray-400 font-mono text-sm">$ ls -la ~/projects/</p>
            </div>
            <a href="/projects/" class="group px-5 py-2.5 text-yellow-400 border border-yellow-400/50 rounded-lg font-mono text-sm font-semibold hover:bg-yellow-400/10 hover:shadow-[0_0_20px_rgba(234,179,8,0.3)] transition-all duration-300 hover:scale-105">
              <span class="flex items-center gap-2">
                Ver Todos
                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
              </span>
            </a>
          </div>
          <ProjectList projects={top6Projects} />
        </section>
      </main>
    </div>
  </div>
</BaseLayout>

<style>
  /* ======= Animaciones ======= */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes gradient {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }
  
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
  }

  .animate-fadeIn {
    animation: fadeIn 1s ease forwards;
  }

  .animate-gradient {
    background-size: 200% 200%;
    animation: gradient 3s ease infinite;
  }

  /* ======= Canvas de part√≠culas ======= */
  #cyber-particles {
    pointer-events: none;
    opacity: 0.25;
  }

  /* ======= Efectos de brillo ======= */
  @keyframes glow {
    0%, 100% { 
      box-shadow: 0 0 20px rgba(234, 179, 8, 0.3),
                  0 0 40px rgba(234, 179, 8, 0.1);
    }
    50% { 
      box-shadow: 0 0 30px rgba(234, 179, 8, 0.5),
                  0 0 60px rgba(234, 179, 8, 0.2);
    }
  }

  /* ======= Scroll suave ======= */
  html {
    scroll-behavior: smooth;
  }
</style>

<script>
  import { initCyberParticles } from '../scripts/cyber-particles';
  initCyberParticles();
</script>
